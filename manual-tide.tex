\documentclass[11pt,twoside,a4paper]{article}
%{book}

% This is an automatically generated file.
% Do not edit it.
% Changes to this file are not preserved!

\usepackage{tocloft}
\usepackage{hyperref}
\usepackage{listings}
\lstset{
basicstyle=\small\ttfamily,
columns=flexible,
breaklines=true
}
\setlength{\cftsubsecnumwidth}{3.5em}

\title{Manual for Package:
tide\protect\\Revision 6M
}
\author{Karl K\"astner}
%\date{}

\begin{document}

\maketitle

\tableofcontents

% licence
% abstract


\section{@T\_Tide}
\subsection{T\_Tide}
${}$
\begin{lstlisting}
 wrapper for TPXO generated tidal time series

\end{lstlisting}
\subsection{build\_index}
${}$
\begin{lstlisting}
 build a structure whose field names contain the index

\end{lstlisting}
\subsection{from\_tpxo}
${}$
\begin{lstlisting}
 read TPXO output into tidetable object

\end{lstlisting}
\subsection{get\_constituents}
${}$
\begin{lstlisting}
 extract constituents of tpxo object

\end{lstlisting}
\subsection{reorder}
${}$
\begin{lstlisting}
 order constituents as specified by "name"

\end{lstlisting}
\subsection{select}
${}$
\begin{lstlisting}
 select a subsect of constituents

\end{lstlisting}
\subsection{shift\_time\_zone}
${}$
\begin{lstlisting}
 shift phase according to time zone

\end{lstlisting}
\section{@Tidal\_Envelope}
\subsection{Tidal\_Envelope}
${}$
\begin{lstlisting}
 process tidal data to extrac the tidal envelope

\end{lstlisting}
\subsection{init}
${}$
\begin{lstlisting}
 initialize with data

\end{lstlisting}
\section{@Tide\_wft}
\begin{lstlisting}
wavelet analysis of tidal data


\end{lstlisting}
\subsection{Tide\_wft}
${}$
\begin{lstlisting}
 wavelet transform of tidal time series

\end{lstlisting}
\subsection{transform}
${}$
\begin{lstlisting}
 wavelet transform tidal time series
 input:
 time   : [1xn] abszissa of input vector, for example time, must be equally spaced
 val    : [1xn] signal, input data series (e.g water level or velocity)
 F      : [1xm] base frequencies, 1, 1, 2, ... for mean level, diurnal, semidirunal ...
 		base periods from base frequencies T=1/F
 n      : [1xm] wavelet window length in multiple of periods
 fc, nc : [scalar] low frequency cutoff and window length in periods
 winstr : [char] fourier windows (kaiser (recommended), hanning, box, etc)
 dt_max : [scalar] maximum time to fill gaps in input data series (recommended 3/24 for tide)
 output:
 tide   : struct with fields
          w_coeff   : [1xn] wavelet coefficients (complex)
          amplitude : amplitude
          phase     : phase
          range     :
          h_tide    :
          h_low     :
          h

\end{lstlisting}
\section{@Tidetable}
\begin{lstlisting}
class for generating tidetable data


\end{lstlisting}
\subsection{Tidetable}
${}$
\begin{lstlisting}
 Tide table

\end{lstlisting}
\subsection{analyze}
${}$
\begin{lstlisting}
 extract tidal envelope from time series

\end{lstlisting}
\subsection{export\_csv}
${}$
\begin{lstlisting}
 export tide table to csv file

\end{lstlisting}
\subsection{generate}
${}$
\begin{lstlisting}
 run TPXO to generate time series

\end{lstlisting}
\subsection{generate\_tpxo\_input}
${}$
\begin{lstlisting}
 generate tpxo input table
 Note: superseeded by perl script

\end{lstlisting}
\subsection{import\_tpxo}
${}$
\begin{lstlisting}
 import TPXO data into tidetable object 

\end{lstlisting}
\subsection{plot\_neap\_spring}
${}$
\begin{lstlisting}
 plot average neap and spring tide

\end{lstlisting}
\section{tide}
\begin{lstlisting}
analysis prediction of tides in rivers and estuaries by empirical and theoretical methods


\end{lstlisting}
\subsection{constituents}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{doodson}
${}$
\begin{lstlisting}
 frequency of tidal constituents
 method of doodson
 source: wikipedia

\end{lstlisting}
\subsection{envelope\_amplitude}
${}$
\begin{lstlisting}
 compute envelopes of hw and low water

\end{lstlisting}
\subsection{envelope\_slack\_water}
${}$
\begin{lstlisting}
 slack water envelope of the tide

\end{lstlisting}
\subsection{interval\_extrema}
${}$
\begin{lstlisting}
 times and evelations for high and low water

\end{lstlisting}
\subsection{interval\_extrema2}
${}$
\begin{lstlisting}
 mimimum and maximum within intervals of constant length,
 intended for periodic functions

\end{lstlisting}
\subsection{interval\_zeros}
${}$
\begin{lstlisting}
 times of slack water determined frim velocity u

\end{lstlisting}
\subsection{lunar\_phase}
${}$
\begin{lstlisting}
 lunar phase

\end{lstlisting}
\subsection{rayleigh\_criterion}
${}$
\begin{lstlisting}
 raleigh criterion for resolving tidal constituents
 T > 1/|f1-f2|

\end{lstlisting}
\section{river-tide/@River\_Tide}
\begin{lstlisting}
predict tide in a backwater affected river with a sloping/varying bed

Assumptions and capabilities:
	- tidal dynamics follow the 1D-Shallow-Water-Equation
	  (depth and cross-sectionally averaged Navier-Stokes-Equation)
	- rectangular cross section
	- width can vary along the channel
	- friction coefficient (cd) constant along channel and over time (Chezy)
	- advective accelleration term is considered, but can be deactivated
	- vertical profile of streamwise velocity is constant
	  (Boussinesq coefficient is unity (1))

Limitations / TODO list:
	- single channel dynamics only (no tidal networks)
	- no wind-shear stress (no storm surges)
	- no tidal flats / intertidal areas (width constant in time)
	- no flood-plain during high-river flow
	- no stratification or along-channel salinty gradient
	- negligible head loss in channel bends
	- negligible feed-back of the sediment concentration on the propagation of the tide
	- low Froude Number (no hydraulic jumps due to cataracts or tidal bores)	

- At present, only two tidal components are supported
  (either D1 with D2 or D2 with D4, in addition to the mean water level z0),
  for mixed diurnal-semidiurnal cases with dominant semidiurnal component,
  the class has to be extended to support three components (D1, D2 and D4)

- At present, the tripel overtide is not computed (D3 for diurnal, D6 for semindiurnal tide),
  note that this is the main overtide for the case of low river flow

- At present, the 1/h non-linearity is only included in the approximations of
  the backwater curve, but not it's influence on the tidal frequency components

Method:

This class calls numerical solvers for second order ordinary differential
equation boundary value problems

Tides is represented as exponential series in form of total discharge Q = sum Q_i = Q_0 + Q_1 + Q_2,
as discharge is conserved (balanced), the equations are simpler than for level z and velocity u,
and the frequency components of z are straight forward determined by differentiation of Q

Class and function structure:
	River_Tide :
		computes river tide, provides the ode coefficients to the boundary value solver
	bvp2c, bvp2fdm :
		solve the underlying second order boundary value problem
	River_Tide_Map :
		provides convenient batch runs and processing of River_Tide instances

Minimum working example, c.f. example_rive_tide.m and example_river_tide_map.m

	input:

	Q0    : scalar, river discharge (m^3/s)
	omega : scalar, angular frequency main tidal species in (1/seconds)
	x     : 2x1 vector, left and right end of computational domain of the river (m)
	w(x)  : function of width along the river (m)
	cd(x) : function of drag coefficient along the river (1)
	zb(x) : function of bed level along the river (m)

	opt   : structure with options
	opt.model_str = 'wave' (other solver are not supported at the moment)
	opt.solver = @bvp2c or @bvp2fdm
	opt.nx : number of grid points along channel
	opt.ns : base for logarithmic spacing of grid points, 1 : linear spacing	

	bc  : structure array of boundary conditions
		r, row 1..2 : left and right end, respectively
		c, column 1 : mean (river) component
		          2..n : condition form column-1 frequency component

		(       q(1)*(p(1) y^-(x0) + p(2) dy^-/dx(x0) ...
                     +  q(2)*(p(1) y^+(x0) + p(2) dy^+/dx(x0) ) = bc(c,r).val
                           = val(0)

	bc(c,r).var : Quantity, either 'z' or 'Q'
	bc(c,r).val : complex amplitude of chosen variable
                      (c.f. (1 + 0i) [m] for surface elevation amplitude of 1m)
		      (value has to be real for mean component)
		      mean component requires z and Q to be specified at opposit ends
	bc(c,r).p   : factor for Dirichlet p(1) or Neumann p(2) condition
		      p = [1,0] : pure Dirichlet 
		      p = [0,1] : pure Neumann
		      sum of abs(p) must be nonzero for each end and each frequency component
	bc(c,r).q   : factor for left and right going wave, only available for bvp2c
		      q = [1,1] : total water level / discharge
		      q = [1,0] : only left going wave
		      q = [0,1] : only right going wave
		      q has no meaning for the mean component and is ignored
		      q is only supported by bvp2c,
                      bvpfdm uses default q = [1,1]
		      sum of abs(q) for each frequency component must be zero


\end{lstlisting}
\subsection{River\_Tide}
${}$
\begin{lstlisting}
 river tide in a single 1D channel
 TODO split in two classes:
 one that stores data (RT_Solve), one that provides equations (RT_Analytic)

\end{lstlisting}
\subsection{bc\_transformation}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{bcfun}
${}$
\begin{lstlisting}
 Robin (mixed) boundary conditions for the river tide,
 supplied for each frequency component,
 wrapper that copies values are from the member struct "bc"

       q*(p*Q_1^- + (1-p)*dQ_1^-/dx 
 input :
	x       : coordinate (left or right end)
	id,ccdx : frequency component index
                (1 = 0 omega (mean), 2 : 1 omega, 3 : 2 omega, ...
 columns of bc : frequency
 rows of bc, left, right boundary
 output :
 	p : [2x1] linear combination of Dirichlet and Neumann boundary condition
          p(1) -> weight Dirichlet boundary condition
	    p(2) -> weight Neumann boundary condition
      q linear combination of left and right travelling (incoming and outgoing) wave
	    q(1) weight left going wave
          q(2) weight right going wave
 	rhs = 0 -> homogeneous boundary condition


 function [rhs, p, q, obj] = bcfun(obj,x,y,ccdx)

\end{lstlisting}
\subsection{check\_continuity}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{check\_momentum}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{d2au1\_dx2}
${}$
\begin{lstlisting}
 second derivative of the tidal velocity magnitude

 note: this is for finding zeros,
       the true derivative has to be scaled  up by z

\end{lstlisting}
\subsection{d2az1\_dx2}
${}$
\begin{lstlisting}
 second derivative of the tidal surface elevation

 note: this is for finding zeros,
       the true derivative has to be scaled  up by z

\end{lstlisting}
\subsection{decompose}
${}$
\begin{lstlisting}
 decompose the tide into a right and left travelling wave,
 i.e. into incoming and reflected wave

\end{lstlisting}
\subsection{discharge2level}
${}$
\begin{lstlisting}
 tidal component of surface elevation determined from tidal discharge

 by continuity :

 dz/dt + dq/dx = 0
 => i o z = - dq/dx
 =>     z = -1/(io) dq/dx
 =>     z = 1i/o dq/dx

 TODO allow Q as input
 TODO rename into Q1_to_z1
 Mon  7 Oct 19:04:14 PST 2019 : added correction for change of width

\end{lstlisting}
\subsection{dkq\_dx}
${}$
\begin{lstlisting}
 along-channel derivative of the wave number of the discharge
 neglects width variation

 TODO, rederive with g as variable

\end{lstlisting}
\subsection{dkz\_dx}
${}$
\begin{lstlisting}
 along channel derivative of the wave number of the tidal surface elevation
 ignores width variation dh/dx and second order depth variation (d^2h/dx^2)
 TODO rederive with g symbolic

\end{lstlisting}
\subsection{even\_overtide\_analytic}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{friction\_coefficient\_dronkers}
${}$
\begin{lstlisting}
 friction coefficient according to Dronkers

 the coefficients are semi-autogenerated

 c.f. dronkers 1964
 c.f. Cai 2016

 p = [p0,p1,p2,p3];
 alpha = Ur/Ut = river velocity / tidal velocity amplitude = (umax+umin)/(umax-umin)

 function p = friction_coefficient_dronkers(alpha,order)


\end{lstlisting}
\subsection{friction\_coefficient\_godin}
${}$
\begin{lstlisting}
 friction coefficient according to Godin
 these coefficients are identical to Dronker's for U_R = phi = 0

 function G = friction_coefficient_godin(obj,phi)

\end{lstlisting}
\subsection{friction\_coefficient\_lorentz}
${}$
\begin{lstlisting}
 friction coefficient according to Lorent'z
 identical to Dronker's coefficient for zero river flow
 and a single frequency component
 c.f. Cai
 c.f. Dronkers 

 function L = friction_coefficient_lorentz(obj,phi)

\end{lstlisting}
\subsection{friction\_dronkers}
${}$
\begin{lstlisting}
 friction determined by Dronker's method

 input :
         u    : velocity time series
	   Umid : arithmetic mean of mininmum and maximum velocity
                (not the mean of the velocity, usually non-zero even without river flow)
         Uhr  : half-range of the velocity, less than the sum of
                the frequency amplitudes, except at perigean spring tides

 function [uau_sum uau p] = friction_dronkers(u,Umid,Uhr,order)

\end{lstlisting}
\subsection{friction\_exponential\_dronkers}
${}$
\begin{lstlisting}
 friction coefficicients for the frequency components computed by Dronkers method
 c.f. Dronker's 1964 eq 8.2 and 8.4
 Note: Cai dennominates alpha as phi

 function [c uau uau_ p] = friction_trigonometric_dronkers(u,dp,Umid,Uhr,order,psym)

\end{lstlisting}
\subsection{friction\_godin}
${}$
\begin{lstlisting}
 compute friction with the method of Godin

\end{lstlisting}
\subsection{friction\_trigonometric\_dronkers}
${}$
\begin{lstlisting}
 friction computed by the method of Dronkers
 expressed as coefficients for the frequency components
 c.f. dronkers 1964 eq 8.2 and 8.4
 Note: Cai dennominates alpha as phi

\end{lstlisting}
\subsection{friction\_trigonometric\_godin}
${}$
\begin{lstlisting}
 friction computed by the method of Godin
 expressed as coefficients of the frequency components (trigonometric form)

  function [c, uau] = friction_trigonometric_godin(obj,u,dp,Umax)

\end{lstlisting}
\subsection{friction\_trigonometric\_lorentz}
${}$
\begin{lstlisting}
 friction computed by the method of Lorent'z
 expressed as coefficients of the frequency components (trigonometric form)
 

\end{lstlisting}
\subsection{init}
${}$
\begin{lstlisting}
 provide initial condition by solving the backwater equation for surface level
 TODO this should not be solved as a ivp but included in the bvp iteration
 TODO generate the mesh here and precompute fixed values instead of passing functions
 TODO Q0 should not be a function
 function obj = init(obj, Xi)

\end{lstlisting}
\subsection{mwl\_offset}
${}$
\begin{lstlisting}
 offset of the tidally averaged surface elevation caused by tidal friction
 Linear estimate of the mean water level offset (ignoring feed-back of tide)

\end{lstlisting}
\subsection{mwl\_offset\_2}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{mwl\_offset\_analytic}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{odefun}
${}$
\begin{lstlisting}
 coefficients of the backwater and wave equation for river-tides

\end{lstlisting}
\subsection{odefun0}
${}$
\begin{lstlisting}
 coefficients of the backwater equation for the river tide
 TODO merge with backwater

\end{lstlisting}
\subsection{odefun1}
${}$
\begin{lstlisting}

 coefficients of the differential equation of the main tidal species

 f1 Q'' + f2 Q' + f3 Q + f4 = 0

 TODO rename f into c
 TODO better pass dzb_dx instead of dz0_dx
 TODO aa, oh and gh terms are not tested for width ~= 1


\end{lstlisting}
\subsection{odefun2}
${}$
\begin{lstlisting}
 coefficients of the ordinary differential quation of the even overtide

\end{lstlisting}
\subsection{solve}
${}$
\begin{lstlisting}
 call stationary or non-stationary solver respectively

 function obj   = solve(obj)

\end{lstlisting}
\subsection{solve\_swe}
${}$
\begin{lstlisting}
 determine river tide by the fully non-stationary FVM and then extract the tide
  this is experimental and not yet fully working

\end{lstlisting}
\subsection{solve\_wave}
${}$
\begin{lstlisting}
 solve for the oscillatory (tidal) componets

 function obj   = solve_wave(obj)

\end{lstlisting}
\subsection{wave\_number\_analytic}
${}$
\begin{lstlisting}
 analytic expression of the wave number

 valid for both tidally, river dominated and low friction conditions
 and converging channels

 k      : complex wave number in a reach with constant width and bed slope
 im(k)  : damping modulus (rate of amplitude change)
 re(k)  : actual wave number (rate of phase change)

 c.f. derive_wave_number


\end{lstlisting}
\subsection{wave\_number\_approximation}
${}$
\begin{lstlisting}
 approximate wave number of the left and right traveling wave for variable coefficients

 TODO merge with wave_number_analytic

 function [k, k0, dk0_dx_rel, obj] = wave_numer_aproximation(obj)

\end{lstlisting}
\section{river-tide/@River\_Tide\_Cai}
\begin{lstlisting}
Prediction of river tide by the method of Cai
c.f. Cai 2013, Cai 2015


\end{lstlisting}
\subsection{Gamma}
${}$
\begin{lstlisting}
 Gamma parameter for tidal propagation
 c.f. Cai 2014

\end{lstlisting}
\subsection{River\_Tide\_Cai}
${}$
\begin{lstlisting}
 prediction of river tide by the method of Cai (2014)

\end{lstlisting}
\subsection{river\_tide\_cai\_}
${}$
\begin{lstlisting}
 determine the surface amplitude of the river-tide
 c.f. Cai

\end{lstlisting}
\subsection{rt\_quantities}
${}$
\begin{lstlisting}
 determine the quantities that determine the tidal propagation
 c.f. Cai
 
 Note: this computes 4 unknowns following Cai, however,
 lambda, mu and epsilon can be substituted
 making it an equation in one unknown (delta) only

\end{lstlisting}
\section{river-tide/@River\_Tide\_Empirical}
\begin{lstlisting}
Empirical fit to measurement and prediction (from tide at sea and river discharge)
of the river tide


\end{lstlisting}
\subsection{River\_Tide\_Empirical}
${}$
\begin{lstlisting}
 class for fitting models to at-a-station time series of tidal elevation

\end{lstlisting}
\subsection{fit\_amplitude}
${}$
\begin{lstlisting}
 fit the oscillatory components

\end{lstlisting}
\subsection{fit\_mwl}
${}$
\begin{lstlisting}
 fit the tidally averaged water level

\end{lstlisting}
\subsection{fit\_phase}
${}$
\begin{lstlisting}
 fit the phase of the oscillatory components

\end{lstlisting}
\subsection{fit\_range}
${}$
\begin{lstlisting}
 fit the tidal range

\end{lstlisting}
\subsection{predict\_amplitude}
${}$
\begin{lstlisting}
 predict the oscillatory components

\end{lstlisting}
\subsection{predict\_mwl}
${}$
\begin{lstlisting}
 predict the mean water level

\end{lstlisting}
\subsection{predict\_phase}
${}$
\begin{lstlisting}
 predict tidal phase 

\end{lstlisting}
\subsection{predict\_range}
${}$
\begin{lstlisting}
 predict the tidal range

\end{lstlisting}
\subsection{rt\_model}
${}$
\begin{lstlisting}
 select the model for fitting

\end{lstlisting}
\section{river-tide/@River\_Tide\_JK}
\begin{lstlisting}
empirical analysis and prediction of river tides by the method of Jay and Kukulka


\end{lstlisting}
\subsection{River\_Tide\_JK}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{damping\_modulus}
${}$
\begin{lstlisting}
 damping modulus of the river tide
 c.f. Jay and Kukula
 function r = damping_modulus(obj,h0,b,Qr)

\end{lstlisting}
\subsection{mean\_level}
${}$
\begin{lstlisting}
 tidally averaged surface elevation
 c.f. Jay and Kukulka

\end{lstlisting}
\subsection{rivertide\_predict}
${}$
\begin{lstlisting}
 predict river tide by the method of jay and kukulka
 TODO rename

\end{lstlisting}
\subsection{rivertide\_regress}
${}$
\begin{lstlisting}
 Regression of tidal coefficients according to Jay & Kulkulka

 coefficients of the r-regression factor 2 apart for specis (jay C7)
 this can be repeated for each tidal species (diurnal, semidiurnal)

\end{lstlisting}
\subsection{tidal\_discharge}
${}$
\begin{lstlisting}
 tidal discharge
 c.f. Jay and Kukulka
 function Qt = tidal_discharge(obj,x,R0,h0,b,Qr)

\end{lstlisting}
\subsection{tidal\_range}
${}$
\begin{lstlisting}
 predict tidal range

\end{lstlisting}
\section{river-tide/@River\_Tide\_Map}
\begin{lstlisting}
hash container for a set of River_Tide predictions for different boundary conditions


\end{lstlisting}
\subsection{River\_Tide\_Map}
${}$
\begin{lstlisting}
 container class to store individual river tide scenarios

\end{lstlisting}
\subsection{fun}
${}$
\begin{lstlisting}
 compute river tide for a scenario with specific boundary conditions and store it in the hash,
 or retrive the scenario, if it was already computed

\end{lstlisting}
\subsection{key}
${}$
\begin{lstlisting}
 key for storing a scenario

 function [key obj] = key(obj,varargin)

\end{lstlisting}
\subsection{plot}
${}$
\begin{lstlisting}
 quick plot of scenario result

 function obj = plot(obj,Xi,Q0,W0,S0,z1_downstream,cd,zb_downstream,omega,q,opt)

\end{lstlisting}
\section{river-tide/@River\_Tide\_Network}
\begin{lstlisting}
predict tides in a fluvial channel network

\end{lstlisting}
\subsection{River\_Tide\_Network}
${}$
\begin{lstlisting}
 tide in a fluvial delta channel network, extension of 1D river tide
 the network is a directed graph
 TODO convert from trig-to exponential form

\end{lstlisting}
\subsection{discharge\_amplitude}
${}$
\begin{lstlisting}
 discharge amplitude

\end{lstlisting}
\subsection{mean\_water\_level}
${}$
\begin{lstlisting}
 predict the mean water level

\end{lstlisting}
\subsection{plot\_mean\_water\_level}
${}$
\begin{lstlisting}
 plot tidally averaged water level

\end{lstlisting}
\subsection{plot\_water\_level\_amplitude}
${}$
\begin{lstlisting}
 plot surface elevation amplitude

\end{lstlisting}
\subsection{solve}
${}$
\begin{lstlisting}
 solve for the tide in a fluvial chanel network

 boundary condition at end points not connected to junctions
 	[ channel 1 id, endpoint id (1 or 2), s0, c0
        ...
         channel n id, endpoint id (1 or 2), s0, c0]

 conditions at junctions are specified as cells
	 each cell contains an nx2 array
	 n : number of connecting channels
	 [channel id1, endpoint id (1 or 2), ...
         channel idn, endpoint id (1 or 2)]

 every tidal species for each channel has 4 unknowns
 these are 2x2 unknowns for the sin + cos of left and right going wave

\end{lstlisting}
\subsection{water\_level\_amplitude}
${}$
\begin{lstlisting}
 predict the surface elevation amplitude

\end{lstlisting}
\section{river-tide}
\begin{lstlisting}
analysis and prediction of river tides

Sub-Classes:
 
@River_Tide
	- prediction of river tide in a backwater affected river with a sloping bed
@River_Tide_Cai
	- prediction of river tide, method of Cai
@River_Tide_Empirical
	- prediction of river tide, empirical
@River_Tide_JK
	- prediction of river tide, empirical after Jay and Kukulka
@River_Tide_Map
	- mulitple-scenaria container for River_Tide
@River_Tide_Network
	- extension of River_Tide to networks


\end{lstlisting}
\subsection{damped\_wave\_bvp}
${}$
\begin{lstlisting}
 solved damped wave equation
 z'' + a z = 0
 z(0) = z0, z(L) = 0

\end{lstlisting}
\subsection{damped\_wave\_ivp}
${}$
\begin{lstlisting}
 linearly damped wave in rectangular channel
 solve tide as initial value problem
 damped wave approximation

 z'' + a z = 0

 x_t = Ax + b

\end{lstlisting}
\subsection{damping\_modulus\_river}
${}$
\begin{lstlisting}
 damping modulus of the tidal wave for river flow only

\end{lstlisting}
\subsection{rdamping\_to\_cdrag\_tide}
${}$
\begin{lstlisting}
 converts damping rate to drag coefficient
 c.f. friedrichs, ippen harleman

\end{lstlisting}
\subsection{river\_tide\_godin}
${}$
\begin{lstlisting}
 analytic solution to the river tide formulated as boundary value problem
 in a river with finite length

 c.f. Godin 1986


\end{lstlisting}
\subsection{rt\_celerity}
${}$
\begin{lstlisting}
 celerity of the tidal wave

\end{lstlisting}
\subsection{rt\_quasi\_stationary\_complex}
${}$
\begin{lstlisting}
 quasi-stationary solution of the SWE
 TODO staggered grid does not help: q1' needed

\end{lstlisting}
\subsection{rt\_quasi\_stationary\_trigonometric}
${}$
\begin{lstlisting}
 quasi statinary form of the SWE

\end{lstlisting}
\subsection{rt\_reflection\_coefficient\_gradual}
${}$
\begin{lstlisting}
 reflection coefficient for gradual varying cross section geometry
 without damping

\end{lstlisting}
\subsection{rt\_wave\_equation}
${}$
\begin{lstlisting}
 solve river tide as boundary value problem

 input:
 omega : [nfx1] angluar frequency of tidal component, zero for mean flow
 reach : [nrx1] struct
 .L    : [1x1]  length of reaches
	 .width(x,h)	width
	 .bed(x,h)	bed level
	 .surface(x,h)	surface elevation
	 .Cd(x,h)	drag coefficient
 .bc   : [nd,nf] boundary/junction conditions
	  bc(id,if).type : {surface, velocity, discharge} (dirichlet)
	  bc(id,if).val  : value
 opt   : [1x1] struct
	- constant surface elevation
	- deactivative advective acceleration
 	.dx : spatial resolution

 dimensions:
	nr : nurmber or reaches
	nd : upstream/downstream index
	nf : frequency index

\end{lstlisting}
\subsection{rt\_z2q}
${}$
\begin{lstlisting}
 determine tidal discharge from water level for tidal wave

\end{lstlisting}
\section{river-tide/test/test}
\subsection{test\_bvp2c\_sym}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_celerity}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_characteristic\_rate\_of\_change}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_dronkers\_compound}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_friction\_dronkers}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_fv\_compare\_schemes}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_fv\_convergence}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_power\_series}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_reflection\_coefficient\_gradual}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_ricatti}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_river\_tide\_models}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_rt\_reflection}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_rt\_zs0}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_swe}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_utm2latlon}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_wave\_twopass}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{river-tide/test}
\subsection{test\_bvp2c2}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_complex\_even\_overtide}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_fourier\_power\_exp}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_friction}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_reflection}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_rt\_wave\_number}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_tidal\_river\_network}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_tidal\_river\_network\_z0}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_wave\_number\_godin}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_wave\_numer\_aproximation}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{river-tide}
\begin{lstlisting}
analysis and prediction of river tides

Sub-Classes:
 
@River_Tide
	- prediction of river tide in a backwater affected river with a sloping bed
@River_Tide_Cai
	- prediction of river tide, method of Cai
@River_Tide_Empirical
	- prediction of river tide, empirical
@River_Tide_JK
	- prediction of river tide, empirical after Jay and Kukulka
@River_Tide_Map
	- mulitple-scenaria container for River_Tide
@River_Tide_Network
	- extension of River_Tide to networks


\end{lstlisting}
\subsection{tidal\_ellipse}
${}$
\begin{lstlisting}
 tidal ellipse, numerical ode solution

\end{lstlisting}
\subsection{wave\_number\_tide}
${}$
\begin{lstlisting}
 wave number of the tide without river flow
 c.f. friedrichs, ippen harleman
 output :
 k : wave number, such that
                  z(t,x) = z1(t,0) exp(1i*(omega*t-k*x))

  re(k) : rate of phase change
 -im(k) : damping rate

 function [k k_low k_high] = damping_modulus_tide(omega,cd,h0,az1)

\end{lstlisting}
\subsection{wavetrainz}
${}$
\begin{lstlisting}
 determine river tide by iterated integration of the surface elevation

\end{lstlisting}
\subsection{wavetwopassz}
${}$
\begin{lstlisting}
 two pass solution for the linearised wave equation, for surface elevation

\end{lstlisting}
\section{test/river-tide}
\subsection{example\_river\_tide}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{example\_river\_tide\_map}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test\_01}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test\_02}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test\_03}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test\_04}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test\_05}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test\_06}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test\_07}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test\_08}
${}$
\begin{lstlisting}
		hold on;
		plot(x,abs(z),'--');
		hold on;
		plot(x,angle(z),'--');

\end{lstlisting}
\subsection{river\_tide\_test\_09}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test\_10}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{river\_tide\_test\_plot}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{test}
\subsection{test\_tidal\_harmonic\_analysis}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{tide}
\begin{lstlisting}
analysis prediction of tides in rivers and estuaries by empirical and theoretical methods


\end{lstlisting}
\subsection{tidal\_constituents}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{tidal\_energy\_transport\_1d}
${}$
\begin{lstlisting}
 energy transport of a tidal wave

\end{lstlisting}
\subsection{tidal\_envelope}
${}$
\begin{lstlisting}
 envelope of the tide

 input : t time in days
         f surface elevation
 ouput : tl time of low water
         vl surface elevation at low water
         ldx index of low water
         th time of high water
         vh surface elevation at high water
         hdx index of high water
         ndx neap index
         sdx spring index
         dmax:
         drange: range per day

\end{lstlisting}
\subsection{tidal\_envelope2}
${}$
\begin{lstlisting}
 surface levelation envelope of the tide
 low water, high water and tidal range for lunar each day
 

 input:
        time  : 
        L     : surface elevation
        order : interpolation order (default 2)
 ouput:
        timei : vector eqispaced
        lmini : minimum level
        lmaxi : maximum level
        rangei : range
        midrangei : (min + max)/2, usually different from mean
        phii  : pseudo phase

 Note: the pseudo phase phi jumps, this is because if the tide is semidiurnal,
       sometimes the lower hw becomes the next day higher then than the 
	current high water, e.g. there is no smooth transition by
       51min but a jump by 12h

\end{lstlisting}
\subsection{tidal\_harmonic\_analysis}
${}$
\begin{lstlisting}
 tidal_harmonic analysis

\end{lstlisting}
\section{tide-savenije}
\subsection{savenije\_phase\_lag}
${}$
\begin{lstlisting}
 phase lag of high and low water

 phi : u_river/u_tide < 1

 delta_eps_hw = omega*(t_hws - t_hw)
 delta_eps_hw = omega*(t_lws - t_lw)

 c.f. savenije

\end{lstlisting}
\subsection{savenije\_tidal\_range}
${}$
\begin{lstlisting}
 tidal range

 based on Savenije 2012

 x    : distance to river mouth
 eta  : range
 eta0 : range at river mouth
 hbar : mean water depth
 phi  : velocity ratio u_tide/u_river 
	 note: this varies in strongly convergent estuaries
 K    : mannings coefficient
 I    : residual surface slope I

\end{lstlisting}
\subsection{savenije\_tidal\_range1}
${}$
\begin{lstlisting}
 tidal range

 based on Horrevoets/Savenije, 2004

 H0   : tidal range at river mouth
 h0   : initial water depth
 v    : velocity scale
 b    : convergence length
 sine : phase lag
 K    : Mannings coefficient
 Q_r   : river discharge

\end{lstlisting}
\subsection{savenije\_timing\_hw\_lw}
${}$
\begin{lstlisting}
 time of high water and low water
 c.f. savenije 2012

\end{lstlisting}
\subsection{tide-savenije}
${}$
\begin{lstlisting}

\end{lstlisting}
\end{document}
