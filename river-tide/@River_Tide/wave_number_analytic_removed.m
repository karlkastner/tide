if (0)
	dk0 = [((Q.*cd.*2+pi.*h.^2.*omega.*w.*1i).*(Q.*cd.*dw_dx.*h+Q.*cd.*dh_dx.*w.*3-pi.*dh_dx.*h.^2.*omega.*w.^2.*5.0e-1i).*2)./(pi.^2.*h.^5.*omega.^2.*w.^3.*4+Q.^2.*cd.^2.*h.*w.*16), ...
	       ((Q.*cd.*2+pi.*h.^2.*omega.*w.*1i).*(Q.*cd.*dw_dx.*h+Q.*cd.*dh_dx.*w.*3-pi.*dh_dx.*h.^2.*omega.*w.^2.*5.0e-1i).*2)./(pi.^2.*h.^5.*omega.^2.*w.^3.*4+Q.^2.*cd.^2.*h.*w.*16)];
	kq = k0 + dk0;
	kz = k0 - dk0;
end

	if (0) 
	
	% TODO, this is only valid for order == 2
	re = -omega.^2./(g.*h);
	im = (   p1./Pi.*omega.*cd./g.*qt./h.^3 ... 
	       + p2./Pi.*2.*omega.*cd./g.*q0./h.^3 );

	if (~obj.issym)
		k0_ = sqrt(re + 1i*im);
	else
		% Note: if the imaginary part later becomes zero,
		%       this is invalid
		[k_re, k_im]  = root_complex(re,im);
		k0_            = k_re+1i*k_im;
	end

	% TODO, this ignores change of width along channel
	% assumptions:
	% dQt/dx neglibible (river dominance)
	% d^2h_dx^2 negligible
	%
	a          = 1/pi*cd./(omega*h.^2.*w).*(p2.*Q0 + 1/2*p1.*Qt);
	dk0_dx_rel = -(3*a.^2 + 1i*a + 1/4)./(4*a.^2 + 1).*(dh_dx./h);
	kz         = k0 - dk0_dx_rel;
	kq         = k0 + dk0_dx_rel;


	if (nargout() > 1)
	if (~obj.issym)
		%k0         = [k0,-k0];
      		%dk0_dx     = derivative1(x,k0);                                         
	        dk0_dx_rel = bsxfun(@times,1./((k0(:,1)-k0(:,2))),dk0_dx);              

		% -(dhdxval*(3*a^2 + a*i + 1/4))/(h*(4*a^2 + 1))

		% wave number of upstream downstream traveling waves
		k = [ k0(:,1) - dk0_dx_rel(:,1), ...
        	     -k0(:,2) - dk0_dx_rel(:,2)];
	else
		% TODO, this is only with respect to depth
		syms dh_dx p2 real
		% TODO this needs to be simplified before differentiation
		% when p2==pi

if (0)
	% simplified
	kz = [(dh_dx.*-7.5e-1i)./h-(dw_dx.*1i)./w+(1.0./sqrt(pi).*1.0./sqrt(g).*1.0./h.^(3.0./2.0).*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0+Q.*cd.*omega.*w.*8.0i).*(1.0./2.0))./w-(Q.*cd.*dw_dx.*omega.*2.0)./(pi.*h.^2.*omega.^2.*w.^2.*4.0+Q.*cd.*omega.*w.*8.0i)+(pi.*dh_dx.*h.*omega.^2.*w.^2.*2.0i)./(pi.*h.^2.*omega.^2.*w.^2.*4.0+Q.*cd.*omega.*w.*8.0i)+(pi.*dw_dx.*h.^2.*omega.^2.*w.*2.0i)./(pi.*h.^2.*omega.^2.*w.^2.*4.0+Q.*cd.*omega.*w.*8.0i), ...
	(dh_dx.*-7.5e-1i)./h-(dw_dx.*1i)./w-(1.0./sqrt(pi).*1.0./sqrt(g).*1.0./h.^(3.0./2.0).*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0+Q.*cd.*omega.*w.*8.0i).*(1.0./2.0))./w-(Q.*cd.*dw_dx.*omega.*2.0)./(pi.*h.^2.*omega.^2.*w.^2.*4.0+Q.*cd.*omega.*w.*8.0i)+(pi.*dh_dx.*h.*omega.^2.*w.^2.*2.0i)./(pi.*h.^2.*omega.^2.*w.^2.*4.0+Q.*cd.*omega.*w.*8.0i)+(pi.*dw_dx.*h.^2.*omega.^2.*w.*2.0i)./(pi.*h.^2.*omega.^2.*w.^2.*4.0+Q.*cd.*omega.*w.*8.0i)];

%	kz = [1.0./sqrt(pi).*1.0./sqrt(g).*1.0./h.^(3.0./2.0).*1.0./omega.^(5.0./2.0).*1.0./w.^(7.0./2.0).*1.0./(Q.*cd.*2.0i+pi.*h.^2.*omega.*w).^(7.0./2.0).*(Q.^4.*cd.^4.*omega.^3.*w.^3.*-6.4e1i-pi.^4.*h.^8.*omega.^7.*w.^7.*4.0i+pi.^3.*Q.*cd.*h.^6.*omega.^6.*w.^6.*3.2e1-pi.*Q.^3.*cd.^3.*h.^2.*omega.^4.*w.^4.*1.28e2+pi.^2.*Q.^2.*cd.^2.*h.^4.*omega.^5.*w.^5.*9.6e1i-pi.^4.*dh_dx.*dw_dx.*g.*h.^8.*omega.^5.*w.^6+pi.^(3.0./2.0).*dh_dx.*sqrt(g).*h.^(5.0./2.0).*omega.^(7.0./2.0).*w.^(9.0./2.0).*(Q.*cd.*2.0i+pi.*h.^2.*omega.*w).^(5.0./2.0).*(1.0-2.0i)+pi.^(3.0./2.0).*dw_dx.*sqrt(g).*h.^(7.0./2.0).*omega.^(7.0./2.0).*w.^(7.0./2.0).*(Q.*cd.*2.0i+pi.*h.^2.*omega.*w).^(5.0./2.0).*(2.0-4.0i)+pi.^2.*Q.^2.*cd.^2.*dh_dx.*dw_dx.*g.*h.^4.*omega.^3.*w.^4.*2.8e1-pi.^3.*Q.*cd.*dh_dx.*dw_dx.*g.*h.^6.*omega.^4.*w.^5.*4.0i+sqrt(pi).*Q.*cd.*dh_dx.*sqrt(g).*sqrt(h).*omega.^(5.0./2.0).*w.^(7.0./2.0).*(Q.*cd.*2.0i+pi.*h.^2.*omega.*w).^(5.0./2.0).*(1.2e1+6.0i)+sqrt(pi).*Q.*cd.*dw_dx.*sqrt(g).*h.^(3.0./2.0).*omega.^(5.0./2.0).*w.^(5.0./2.0).*(Q.*cd.*2.0i+pi.*h.^2.*omega.*w).^(5.0./2.0).*(1.2e1+6.0i)+pi.*Q.^3.*cd.^3.*dh_dx.*dw_dx.*g.*h.^2.*omega.^2.*w.^3.*4.8e1i).*(1.0./4.0), ...
%	1.0./sqrt(pi).*1.0./sqrt(g).*1.0./h.^(3.0./2.0).*1.0./omega.^(5.0./2.0).*1.0./w.^(7.0./2.0).*1.0./(Q.*cd.*2.0i+pi.*h.^2.*omega.*w).^(7.0./2.0).*(Q.^4.*cd.^4.*omega.^3.*w.^3.*6.4e1i+pi.^4.*h.^8.*omega.^7.*w.^7.*4.0i-pi.^3.*Q.*cd.*h.^6.*omega.^6.*w.^6.*3.2e1+pi.*Q.^3.*cd.^3.*h.^2.*omega.^4.*w.^4.*1.28e2-pi.^2.*Q.^2.*cd.^2.*h.^4.*omega.^5.*w.^5.*9.6e1i+pi.^4.*dh_dx.*dw_dx.*g.*h.^8.*omega.^5.*w.^6+pi.^(3.0./2.0).*dh_dx.*sqrt(g).*h.^(5.0./2.0).*omega.^(7.0./2.0).*w.^(9.0./2.0).*(Q.*cd.*2.0i+pi.*h.^2.*omega.*w).^(5.0./2.0).*(1.0-2.0i)+pi.^(3.0./2.0).*dw_dx.*sqrt(g).*h.^(7.0./2.0).*omega.^(7.0./2.0).*w.^(7.0./2.0).*(Q.*cd.*2.0i+pi.*h.^2.*omega.*w).^(5.0./2.0).*(2.0-4.0i)-pi.^2.*Q.^2.*cd.^2.*dh_dx.*dw_dx.*g.*h.^4.*omega.^3.*w.^4.*2.8e1+pi.^3.*Q.*cd.*dh_dx.*dw_dx.*g.*h.^6.*omega.^4.*w.^5.*4.0i+sqrt(pi).*Q.*cd.*dh_dx.*sqrt(g).*sqrt(h).*omega.^(5.0./2.0).*w.^(7.0./2.0).*(Q.*cd.*2.0i+pi.*h.^2.*omega.*w).^(5.0./2.0).*(1.2e1+6.0i)+sqrt(pi).*Q.*cd.*dw_dx.*sqrt(g).*h.^(3.0./2.0).*omega.^(5.0./2.0).*w.^(5.0./2.0).*(Q.*cd.*2.0i+pi.*h.^2.*omega.*w).^(5.0./2.0).*(1.2e1+6.0i)-pi.*Q.^3.*cd.^3.*dh_dx.*dw_dx.*g.*h.^2.*omega.^2.*w.^3.*4.8e1i).*(1.0./4.0)];
else

%	kz = [(pi.*g.*h.^2.*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(-pi.*dw_dx.^3.*g.*h.^4+pi.*dh_dx.*h.^2.*omega.^2.*w.^3+pi.*dw_dx.*h.^3.*omega.^2.*w.^2.*2.0+Q.*cd.*dh_dx.*omega.*w.^2.*6.0i+Q.*cd.*dw_dx.*h.*omega.*w.*6.0i).*(pi.^3.*dw_dx.^6.*g.^3.*h.^9.*(8.0-8.0i)+Q.^3.*cd.^3.*omega.^3.*w.^3.*5.12e2i-pi.^3.*h.^6.*omega.^6.*w.^6.*6.4e1+sqrt(pi).*dw_dx.*sqrt(g).*h.^(3.0./2.0).*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(5.0./2.0).*(-4.0-4.0i)+pi.^(3.0./2.0).*dw_dx.^3.*g.^(3.0./2.0).*h.^(9.0./2.0).*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(4.0+4.0i)+pi.^3.*dw_dx.^4.*g.^2.*h.^8.*omega.^2.*w.^2.*(-4.8e1+6.4e1i)-pi.^2.*Q.*cd.*h.^4.*omega.^5.*w.^5.*3.84e2i+pi.*Q.^2.*cd.^2.*h.^2.*omega.^4.*w.^4.*7.68e2+pi.^3.*dh_dx.^2.*g.*h.^5.*omega.^4.*w.^6.*(4.0-1.6e1i)+pi.^3.*dw_dx.^2.*g.*h.^7.*omega.^4.*w.^4.*(9.6e1-6.4e1i)+sqrt(pi).*dh_dx.*sqrt(g).*sqrt(h).*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(5.0./2.0).*(-3.0-3.0i)+pi.^(3.0./2.0).*dh_dx.*sqrt(g).*h.^(5.0./2.0).*omega.^2.*w.^3.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(8.0+8.0i)+pi.^(3.0./2.0).*dw_dx.*sqrt(g).*h.^(7.0./2.0).*omega.^2.*w.^2.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(8.0+8.0i)+pi.^3.*dh_dx.*dw_dx.^3.*g.^2.*h.^7.*omega.^2.*w.^3.*(-8.0-1.2e1i)+pi.^(5.0./2.0).*dw_dx.^3.*g.^(3.0./2.0).*h.^(1.3e1./2.0).*omega.^2.*w.^2.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(8.0-8.0i)+pi.^3.*dh_dx.*dw_dx.*g.*h.^6.*omega.^4.*w.^5.*(1.6e1-1.6e1i)-pi.^(3.0./2.0).*dh_dx.*dw_dx.^2.*g.^(3.0./2.0).*h.^(7.0./2.0).*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*6.0+pi.^(5.0./2.0).*dh_dx.*dw_dx.^4.*g.^(5.0./2.0).*h.^(1.3e1./2.0).*w.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(-3.0+3.0i)+pi.^3.*dh_dx.^2.*dw_dx.^2.*g.^2.*h.^6.*omega.^2.*w.^4.*8.0i+pi.*Q.^2.*cd.^2.*dh_dx.^2.*g.*h.*omega.^2.*w.^4.*(-1.44e2+1.92e2i)+pi.^2.*Q.*cd.*dh_dx.^2.*g.*h.^3.*omega.^3.*w.^5.*(2.56e2+4.8e1i)+pi.^2.*Q.*cd.*dw_dx.^2.*g.*h.^5.*omega.^3.*w.^3.*(3.52e2+4.16e2i)+pi.*Q.^2.*cd.^2.*dw_dx.^2.*g.*h.^3.*omega.^2.*w.^2.*(-4.64e2+3.84e2i)+pi.^(5.0./2.0).*dh_dx.*dw_dx.^2.*g.^(3.0./2.0).*h.^(1.1e1./2.0).*omega.^2.*w.^3.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(8.0-8.0i)+pi.^2.*Q.*cd.*dw_dx.^4.*g.^2.*h.^6.*omega.*w.*(-1.2e2-1.12e2i)+sqrt(pi).*Q.*cd.*dw_dx.*sqrt(g).*h.^(3.0./2.0).*omega.*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(-8.0+8.0i)-pi.^2.*Q.*cd.*dh_dx.^2.*dw_dx.^2.*g.^2.*h.^4.*omega.*w.^3.*9.6e1+pi.^2.*Q.*cd.*dh_dx.*dw_dx.*g.*h.^4.*omega.^3.*w.^4.*(2.56e2+1.44e2i)+pi.^(3.0./2.0).*Q.*cd.*dw_dx.^3.*g.^(3.0./2.0).*h.^(9.0./2.0).*omega.*w.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(8.0+8.0i)+pi.*Q.^2.*cd.^2.*dh_dx.*dw_dx.*g.*h.^2.*omega.^2.*w.^3.*(-2.88e2+1.92e2i)+pi.^2.*Q.*cd.*dh_dx.*dw_dx.^3.*g.^2.*h.^5.*omega.*w.^2.*(2.4e1-4.8e1i)).*(-1.0./4.0)+sqrt(pi).*sqrt(g).*h.^(3.0./2.0).*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(pi.*h.^2.*omega.^2.*w.^2.*-4.0i+pi.*dw_dx.^2.*g.*h.^3.*2.0i+Q.*cd.*omega.*w.*8.0).*(pi.^3.*dw_dx.^6.*g.^3.*h.^9.*(8.0-8.0i)+Q.^3.*cd.^3.*omega.^3.*w.^3.*5.12e2i-pi.^3.*h.^6.*omega.^6.*w.^6.*6.4e1+sqrt(pi).*dw_dx.*sqrt(g).*h.^(3.0./2.0).*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(5.0./2.0).*(-4.0-4.0i)+pi.^(3.0./2.0).*dw_dx.^3.*g.^(3.0./2.0).*h.^(9.0./2.0).*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(4.0+4.0i)+pi.^3.*dw_dx.^4.*g.^2.*h.^8.*omega.^2.*w.^2.*(-4.8e1+6.4e1i)-pi.^2.*Q.*cd.*h.^4.*omega.^5.*w.^5.*3.84e2i+pi.*Q.^2.*cd.^2.*h.^2.*omega.^4.*w.^4.*7.68e2+pi.^3.*dh_dx.^2.*g.*h.^5.*omega.^4.*w.^6.*(4.0-1.6e1i)+pi.^3.*dw_dx.^2.*g.*h.^7.*omega.^4.*w.^4.*(9.6e1-6.4e1i)+sqrt(pi).*dh_dx.*sqrt(g).*sqrt(h).*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(5.0./2.0).*(-3.0-3.0i)+pi.^(3.0./2.0).*dh_dx.*sqrt(g).*h.^(5.0./2.0).*omega.^2.*w.^3.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(8.0+8.0i)+pi.^(3.0./2.0).*dw_dx.*sqrt(g).*h.^(7.0./2.0).*omega.^2.*w.^2.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(8.0+8.0i)+pi.^3.*dh_dx.*dw_dx.^3.*g.^2.*h.^7.*omega.^2.*w.^3.*(-8.0-1.2e1i)+pi.^(5.0./2.0).*dw_dx.^3.*g.^(3.0./2.0).*h.^(1.3e1./2.0).*omega.^2.*w.^2.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(8.0-8.0i)+pi.^3.*dh_dx.*dw_dx.*g.*h.^6.*omega.^4.*w.^5.*(1.6e1-1.6e1i)-pi.^(3.0./2.0).*dh_dx.*dw_dx.^2.*g.^(3.0./2.0).*h.^(7.0./2.0).*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*6.0+pi.^(5.0./2.0).*dh_dx.*dw_dx.^4.*g.^(5.0./2.0).*h.^(1.3e1./2.0).*w.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(-3.0+3.0i)+pi.^3.*dh_dx.^2.*dw_dx.^2.*g.^2.*h.^6.*omega.^2.*w.^4.*8.0i+pi.*Q.^2.*cd.^2.*dh_dx.^2.*g.*h.*omega.^2.*w.^4.*(-1.44e2+1.92e2i)+pi.^2.*Q.*cd.*dh_dx.^2.*g.*h.^3.*omega.^3.*w.^5.*(2.56e2+4.8e1i)+pi.^2.*Q.*cd.*dw_dx.^2.*g.*h.^5.*omega.^3.*w.^3.*(3.52e2+4.16e2i)+pi.*Q.^2.*cd.^2.*dw_dx.^2.*g.*h.^3.*omega.^2.*w.^2.*(-4.64e2+3.84e2i)+pi.^(5.0./2.0).*dh_dx.*dw_dx.^2.*g.^(3.0./2.0).*h.^(1.1e1./2.0).*omega.^2.*w.^3.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(8.0-8.0i)+pi.^2.*Q.*cd.*dw_dx.^4.*g.^2.*h.^6.*omega.*w.*(-1.2e2-1.12e2i)+sqrt(pi).*Q.*cd.*dw_dx.*sqrt(g).*h.^(3.0./2.0).*omega.*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(-8.0+8.0i)-pi.^2.*Q.*cd.*dh_dx.^2.*dw_dx.^2.*g.^2.*h.^4.*omega.*w.^3.*9.6e1+pi.^2.*Q.*cd.*dh_dx.*dw_dx.*g.*h.^4.*omega.^3.*w.^4.*(2.56e2+1.44e2i)+pi.^(3.0./2.0).*Q.*cd.*dw_dx.^3.*g.^(3.0./2.0).*h.^(9.0./2.0).*omega.*w.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(8.0+8.0i)+pi.*Q.^2.*cd.^2.*dh_dx.*dw_dx.*g.*h.^2.*omega.^2.*w.^3.*(-2.88e2+1.92e2i)+pi.^2.*Q.*cd.*dh_dx.*dw_dx.^3.*g.^2.*h.^5.*omega.*w.^2.*(2.4e1-4.8e1i)).*(1.0./8.0))./(pi.*g.*h.^3.*w.^2.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^3.*(pi.*h.^2.*omega.^2.*w.^2.*-2.0i+pi.*dw_dx.^2.*g.*h.^3.*1i+Q.*cd.*omega.*w.*4.0).^2-pi.^2.*g.^2.*h.^4.*w.^2.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^2.*(-pi.*dw_dx.^3.*g.*h.^4+pi.*dh_dx.*h.^2.*omega.^2.*w.^3+pi.*dw_dx.*h.^3.*omega.^2.*w.^2.*2.0+Q.*cd.*dh_dx.*omega.*w.^2.*6.0i+Q.*cd.*dw_dx.*h.*omega.*w.*6.0i).^2), ...
%(pi.*g.*h.^2.*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(-pi.*dw_dx.^3.*g.*h.^4+pi.*dh_dx.*h.^2.*omega.^2.*w.^3+pi.*dw_dx.*h.^3.*omega.^2.*w.^2.*2.0+Q.*cd.*dh_dx.*omega.*w.^2.*6.0i+Q.*cd.*dw_dx.*h.*omega.*w.*6.0i).*(pi.^3.*dw_dx.^6.*g.^3.*h.^9.*(8.0-8.0i)+Q.^3.*cd.^3.*omega.^3.*w.^3.*5.12e2i-pi.^3.*h.^6.*omega.^6.*w.^6.*6.4e1+sqrt(pi).*dw_dx.*sqrt(g).*h.^(3.0./2.0).*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(5.0./2.0).*(4.0+4.0i)+pi.^(3.0./2.0).*dw_dx.^3.*g.^(3.0./2.0).*h.^(9.0./2.0).*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(-4.0-4.0i)+pi.^3.*dw_dx.^4.*g.^2.*h.^8.*omega.^2.*w.^2.*(-4.8e1+6.4e1i)-pi.^2.*Q.*cd.*h.^4.*omega.^5.*w.^5.*3.84e2i+pi.*Q.^2.*cd.^2.*h.^2.*omega.^4.*w.^4.*7.68e2+pi.^3.*dh_dx.^2.*g.*h.^5.*omega.^4.*w.^6.*(4.0-1.6e1i)+pi.^3.*dw_dx.^2.*g.*h.^7.*omega.^4.*w.^4.*(9.6e1-6.4e1i)+sqrt(pi).*dh_dx.*sqrt(g).*sqrt(h).*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(5.0./2.0).*(3.0+3.0i)+pi.^(3.0./2.0).*dh_dx.*sqrt(g).*h.^(5.0./2.0).*omega.^2.*w.^3.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(-8.0-8.0i)+pi.^(3.0./2.0).*dw_dx.*sqrt(g).*h.^(7.0./2.0).*omega.^2.*w.^2.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(-8.0-8.0i)+pi.^3.*dh_dx.*dw_dx.^3.*g.^2.*h.^7.*omega.^2.*w.^3.*(-8.0-1.2e1i)+pi.^(5.0./2.0).*dw_dx.^3.*g.^(3.0./2.0).*h.^(1.3e1./2.0).*omega.^2.*w.^2.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(-8.0+8.0i)+pi.^3.*dh_dx.*dw_dx.*g.*h.^6.*omega.^4.*w.^5.*(1.6e1-1.6e1i)+pi.^(3.0./2.0).*dh_dx.*dw_dx.^2.*g.^(3.0./2.0).*h.^(7.0./2.0).*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*6.0+pi.^(5.0./2.0).*dh_dx.*dw_dx.^4.*g.^(5.0./2.0).*h.^(1.3e1./2.0).*w.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(3.0-3.0i)+pi.^3.*dh_dx.^2.*dw_dx.^2.*g.^2.*h.^6.*omega.^2.*w.^4.*8.0i+pi.*Q.^2.*cd.^2.*dh_dx.^2.*g.*h.*omega.^2.*w.^4.*(-1.44e2+1.92e2i)+pi.^2.*Q.*cd.*dh_dx.^2.*g.*h.^3.*omega.^3.*w.^5.*(2.56e2+4.8e1i)+pi.^2.*Q.*cd.*dw_dx.^2.*g.*h.^5.*omega.^3.*w.^3.*(3.52e2+4.16e2i)+pi.*Q.^2.*cd.^2.*dw_dx.^2.*g.*h.^3.*omega.^2.*w.^2.*(-4.64e2+3.84e2i)+pi.^(5.0./2.0).*dh_dx.*dw_dx.^2.*g.^(3.0./2.0).*h.^(1.1e1./2.0).*omega.^2.*w.^3.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(-8.0+8.0i)+pi.^2.*Q.*cd.*dw_dx.^4.*g.^2.*h.^6.*omega.*w.*(-1.2e2-1.12e2i)+sqrt(pi).*Q.*cd.*dw_dx.*sqrt(g).*h.^(3.0./2.0).*omega.*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(8.0-8.0i)-pi.^2.*Q.*cd.*dh_dx.^2.*dw_dx.^2.*g.^2.*h.^4.*omega.*w.^3.*9.6e1+pi.^2.*Q.*cd.*dh_dx.*dw_dx.*g.*h.^4.*omega.^3.*w.^4.*(2.56e2+1.44e2i)+pi.^(3.0./2.0).*Q.*cd.*dw_dx.^3.*g.^(3.0./2.0).*h.^(9.0./2.0).*omega.*w.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(-8.0-8.0i)+pi.*Q.^2.*cd.^2.*dh_dx.*dw_dx.*g.*h.^2.*omega.^2.*w.^3.*(-2.88e2+1.92e2i)+pi.^2.*Q.*cd.*dh_dx.*dw_dx.^3.*g.^2.*h.^5.*omega.*w.^2.*(2.4e1-4.8e1i)).*(-1.0./4.0)-sqrt(pi).*sqrt(g).*h.^(3.0./2.0).*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(pi.*h.^2.*omega.^2.*w.^2.*-4.0i+pi.*dw_dx.^2.*g.*h.^3.*2.0i+Q.*cd.*omega.*w.*8.0).*(pi.^3.*dw_dx.^6.*g.^3.*h.^9.*(8.0-8.0i)+Q.^3.*cd.^3.*omega.^3.*w.^3.*5.12e2i-pi.^3.*h.^6.*omega.^6.*w.^6.*6.4e1+sqrt(pi).*dw_dx.*sqrt(g).*h.^(3.0./2.0).*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(5.0./2.0).*(4.0+4.0i)+pi.^(3.0./2.0).*dw_dx.^3.*g.^(3.0./2.0).*h.^(9.0./2.0).*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(-4.0-4.0i)+pi.^3.*dw_dx.^4.*g.^2.*h.^8.*omega.^2.*w.^2.*(-4.8e1+6.4e1i)-pi.^2.*Q.*cd.*h.^4.*omega.^5.*w.^5.*3.84e2i+pi.*Q.^2.*cd.^2.*h.^2.*omega.^4.*w.^4.*7.68e2+pi.^3.*dh_dx.^2.*g.*h.^5.*omega.^4.*w.^6.*(4.0-1.6e1i)+pi.^3.*dw_dx.^2.*g.*h.^7.*omega.^4.*w.^4.*(9.6e1-6.4e1i)+sqrt(pi).*dh_dx.*sqrt(g).*sqrt(h).*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(5.0./2.0).*(3.0+3.0i)+pi.^(3.0./2.0).*dh_dx.*sqrt(g).*h.^(5.0./2.0).*omega.^2.*w.^3.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(-8.0-8.0i)+pi.^(3.0./2.0).*dw_dx.*sqrt(g).*h.^(7.0./2.0).*omega.^2.*w.^2.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(-8.0-8.0i)+pi.^3.*dh_dx.*dw_dx.^3.*g.^2.*h.^7.*omega.^2.*w.^3.*(-8.0-1.2e1i)+pi.^(5.0./2.0).*dw_dx.^3.*g.^(3.0./2.0).*h.^(1.3e1./2.0).*omega.^2.*w.^2.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(-8.0+8.0i)+pi.^3.*dh_dx.*dw_dx.*g.*h.^6.*omega.^4.*w.^5.*(1.6e1-1.6e1i)+pi.^(3.0./2.0).*dh_dx.*dw_dx.^2.*g.^(3.0./2.0).*h.^(7.0./2.0).*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*6.0+pi.^(5.0./2.0).*dh_dx.*dw_dx.^4.*g.^(5.0./2.0).*h.^(1.3e1./2.0).*w.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(3.0-3.0i)+pi.^3.*dh_dx.^2.*dw_dx.^2.*g.^2.*h.^6.*omega.^2.*w.^4.*8.0i+pi.*Q.^2.*cd.^2.*dh_dx.^2.*g.*h.*omega.^2.*w.^4.*(-1.44e2+1.92e2i)+pi.^2.*Q.*cd.*dh_dx.^2.*g.*h.^3.*omega.^3.*w.^5.*(2.56e2+4.8e1i)+pi.^2.*Q.*cd.*dw_dx.^2.*g.*h.^5.*omega.^3.*w.^3.*(3.52e2+4.16e2i)+pi.*Q.^2.*cd.^2.*dw_dx.^2.*g.*h.^3.*omega.^2.*w.^2.*(-4.64e2+3.84e2i)+pi.^(5.0./2.0).*dh_dx.*dw_dx.^2.*g.^(3.0./2.0).*h.^(1.1e1./2.0).*omega.^2.*w.^3.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(-8.0+8.0i)+pi.^2.*Q.*cd.*dw_dx.^4.*g.^2.*h.^6.*omega.*w.*(-1.2e2-1.12e2i)+sqrt(pi).*Q.*cd.*dw_dx.*sqrt(g).*h.^(3.0./2.0).*omega.*w.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^(3.0./2.0).*(8.0-8.0i)-pi.^2.*Q.*cd.*dh_dx.^2.*dw_dx.^2.*g.^2.*h.^4.*omega.*w.^3.*9.6e1+pi.^2.*Q.*cd.*dh_dx.*dw_dx.*g.*h.^4.*omega.^3.*w.^4.*(2.56e2+1.44e2i)+pi.^(3.0./2.0).*Q.*cd.*dw_dx.^3.*g.^(3.0./2.0).*h.^(9.0./2.0).*omega.*w.*sqrt(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).*(-8.0-8.0i)+pi.*Q.^2.*cd.^2.*dh_dx.*dw_dx.*g.*h.^2.*omega.^2.*w.^3.*(-2.88e2+1.92e2i)+pi.^2.*Q.*cd.*dh_dx.*dw_dx.^3.*g.^2.*h.^5.*omega.*w.^2.*(2.4e1-4.8e1i)).*(1.0./8.0))./(pi.*g.*h.^3.*w.^2.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^3.*(pi.*h.^2.*omega.^2.*w.^2.*-2.0i+pi.*dw_dx.^2.*g.*h.^3.*1i+Q.*cd.*omega.*w.*4.0).^2-pi.^2.*g.^2.*h.^4.*w.^2.*(pi.*h.^2.*omega.^2.*w.^2.*4.0-pi.*dw_dx.^2.*g.*h.^3+Q.*cd.*omega.*w.*8.0i).^2.*(-pi.*dw_dx.^3.*g.*h.^4+pi.*dh_dx.*h.^2.*omega.^2.*w.^3+pi.*dw_dx.*h.^3.*omega.^2.*w.^2.*2.0+Q.*cd.*dh_dx.*omega.*w.^2.*6.0i+Q.*cd.*dw_dx.*h.*omega.*w.*6.0i).^2)];
